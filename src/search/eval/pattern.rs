/* This Source Code Form is subject to the terms of the Mozilla Public
 * License, v. 2.0. If a copy of the MPL was not distributed with this
 * file, You can obtain one at http://mozilla.org/MPL/2.0/. */

#[cfg(all(target_arch="x86", target_feature="bmi2"))]
use std::arch::x86::{ _pext_u32, _pdep_u32 };

#[cfg(all(target_arch="x86_64", target_feature="bmi2"))]
use std::arch::x86_64::{ _pext_u64, _pdep_u64 };

#[cfg(target_arch="x86_64")]
use std::arch::x86_64::{ _bswap64 };

use crate::board::Board;

const ONES_TERNARY: [usize; 4096] = [
         0,      1,      3,      4,      9,     10,     12,     13,     27,     28,     30,     31,
        36,     37,     39,     40,     81,     82,     84,     85,     90,     91,     93,     94,
       108,    109,    111,    112,    117,    118,    120,    121,    243,    244,    246,    247,
       252,    253,    255,    256,    270,    271,    273,    274,    279,    280,    282,    283,
       324,    325,    327,    328,    333,    334,    336,    337,    351,    352,    354,    355,
       360,    361,    363,    364,    729,    730,    732,    733,    738,    739,    741,    742,
       756,    757,    759,    760,    765,    766,    768,    769,    810,    811,    813,    814,
       819,    820,    822,    823,    837,    838,    840,    841,    846,    847,    849,    850,
       972,    973,    975,    976,    981,    982,    984,    985,    999,   1000,   1002,   1003,
      1008,   1009,   1011,   1012,   1053,   1054,   1056,   1057,   1062,   1063,   1065,   1066,
      1080,   1081,   1083,   1084,   1089,   1090,   1092,   1093,   2187,   2188,   2190,   2191,
      2196,   2197,   2199,   2200,   2214,   2215,   2217,   2218,   2223,   2224,   2226,   2227,
      2268,   2269,   2271,   2272,   2277,   2278,   2280,   2281,   2295,   2296,   2298,   2299,
      2304,   2305,   2307,   2308,   2430,   2431,   2433,   2434,   2439,   2440,   2442,   2443,
      2457,   2458,   2460,   2461,   2466,   2467,   2469,   2470,   2511,   2512,   2514,   2515,
      2520,   2521,   2523,   2524,   2538,   2539,   2541,   2542,   2547,   2548,   2550,   2551,
      2916,   2917,   2919,   2920,   2925,   2926,   2928,   2929,   2943,   2944,   2946,   2947,
      2952,   2953,   2955,   2956,   2997,   2998,   3000,   3001,   3006,   3007,   3009,   3010,
      3024,   3025,   3027,   3028,   3033,   3034,   3036,   3037,   3159,   3160,   3162,   3163,
      3168,   3169,   3171,   3172,   3186,   3187,   3189,   3190,   3195,   3196,   3198,   3199,
      3240,   3241,   3243,   3244,   3249,   3250,   3252,   3253,   3267,   3268,   3270,   3271,
      3276,   3277,   3279,   3280,   6561,   6562,   6564,   6565,   6570,   6571,   6573,   6574,
      6588,   6589,   6591,   6592,   6597,   6598,   6600,   6601,   6642,   6643,   6645,   6646,
      6651,   6652,   6654,   6655,   6669,   6670,   6672,   6673,   6678,   6679,   6681,   6682,
      6804,   6805,   6807,   6808,   6813,   6814,   6816,   6817,   6831,   6832,   6834,   6835,
      6840,   6841,   6843,   6844,   6885,   6886,   6888,   6889,   6894,   6895,   6897,   6898,
      6912,   6913,   6915,   6916,   6921,   6922,   6924,   6925,   7290,   7291,   7293,   7294,
      7299,   7300,   7302,   7303,   7317,   7318,   7320,   7321,   7326,   7327,   7329,   7330,
      7371,   7372,   7374,   7375,   7380,   7381,   7383,   7384,   7398,   7399,   7401,   7402,
      7407,   7408,   7410,   7411,   7533,   7534,   7536,   7537,   7542,   7543,   7545,   7546,
      7560,   7561,   7563,   7564,   7569,   7570,   7572,   7573,   7614,   7615,   7617,   7618,
      7623,   7624,   7626,   7627,   7641,   7642,   7644,   7645,   7650,   7651,   7653,   7654,
      8748,   8749,   8751,   8752,   8757,   8758,   8760,   8761,   8775,   8776,   8778,   8779,
      8784,   8785,   8787,   8788,   8829,   8830,   8832,   8833,   8838,   8839,   8841,   8842,
      8856,   8857,   8859,   8860,   8865,   8866,   8868,   8869,   8991,   8992,   8994,   8995,
      9000,   9001,   9003,   9004,   9018,   9019,   9021,   9022,   9027,   9028,   9030,   9031,
      9072,   9073,   9075,   9076,   9081,   9082,   9084,   9085,   9099,   9100,   9102,   9103,
      9108,   9109,   9111,   9112,   9477,   9478,   9480,   9481,   9486,   9487,   9489,   9490,
      9504,   9505,   9507,   9508,   9513,   9514,   9516,   9517,   9558,   9559,   9561,   9562,
      9567,   9568,   9570,   9571,   9585,   9586,   9588,   9589,   9594,   9595,   9597,   9598,
      9720,   9721,   9723,   9724,   9729,   9730,   9732,   9733,   9747,   9748,   9750,   9751,
      9756,   9757,   9759,   9760,   9801,   9802,   9804,   9805,   9810,   9811,   9813,   9814,
      9828,   9829,   9831,   9832,   9837,   9838,   9840,   9841,  19683,  19684,  19686,  19687,
     19692,  19693,  19695,  19696,  19710,  19711,  19713,  19714,  19719,  19720,  19722,  19723,
     19764,  19765,  19767,  19768,  19773,  19774,  19776,  19777,  19791,  19792,  19794,  19795,
     19800,  19801,  19803,  19804,  19926,  19927,  19929,  19930,  19935,  19936,  19938,  19939,
     19953,  19954,  19956,  19957,  19962,  19963,  19965,  19966,  20007,  20008,  20010,  20011,
     20016,  20017,  20019,  20020,  20034,  20035,  20037,  20038,  20043,  20044,  20046,  20047,
     20412,  20413,  20415,  20416,  20421,  20422,  20424,  20425,  20439,  20440,  20442,  20443,
     20448,  20449,  20451,  20452,  20493,  20494,  20496,  20497,  20502,  20503,  20505,  20506,
     20520,  20521,  20523,  20524,  20529,  20530,  20532,  20533,  20655,  20656,  20658,  20659,
     20664,  20665,  20667,  20668,  20682,  20683,  20685,  20686,  20691,  20692,  20694,  20695,
     20736,  20737,  20739,  20740,  20745,  20746,  20748,  20749,  20763,  20764,  20766,  20767,
     20772,  20773,  20775,  20776,  21870,  21871,  21873,  21874,  21879,  21880,  21882,  21883,
     21897,  21898,  21900,  21901,  21906,  21907,  21909,  21910,  21951,  21952,  21954,  21955,
     21960,  21961,  21963,  21964,  21978,  21979,  21981,  21982,  21987,  21988,  21990,  21991,
     22113,  22114,  22116,  22117,  22122,  22123,  22125,  22126,  22140,  22141,  22143,  22144,
     22149,  22150,  22152,  22153,  22194,  22195,  22197,  22198,  22203,  22204,  22206,  22207,
     22221,  22222,  22224,  22225,  22230,  22231,  22233,  22234,  22599,  22600,  22602,  22603,
     22608,  22609,  22611,  22612,  22626,  22627,  22629,  22630,  22635,  22636,  22638,  22639,
     22680,  22681,  22683,  22684,  22689,  22690,  22692,  22693,  22707,  22708,  22710,  22711,
     22716,  22717,  22719,  22720,  22842,  22843,  22845,  22846,  22851,  22852,  22854,  22855,
     22869,  22870,  22872,  22873,  22878,  22879,  22881,  22882,  22923,  22924,  22926,  22927,
     22932,  22933,  22935,  22936,  22950,  22951,  22953,  22954,  22959,  22960,  22962,  22963,
     26244,  26245,  26247,  26248,  26253,  26254,  26256,  26257,  26271,  26272,  26274,  26275,
     26280,  26281,  26283,  26284,  26325,  26326,  26328,  26329,  26334,  26335,  26337,  26338,
     26352,  26353,  26355,  26356,  26361,  26362,  26364,  26365,  26487,  26488,  26490,  26491,
     26496,  26497,  26499,  26500,  26514,  26515,  26517,  26518,  26523,  26524,  26526,  26527,
     26568,  26569,  26571,  26572,  26577,  26578,  26580,  26581,  26595,  26596,  26598,  26599,
     26604,  26605,  26607,  26608,  26973,  26974,  26976,  26977,  26982,  26983,  26985,  26986,
     27000,  27001,  27003,  27004,  27009,  27010,  27012,  27013,  27054,  27055,  27057,  27058,
     27063,  27064,  27066,  27067,  27081,  27082,  27084,  27085,  27090,  27091,  27093,  27094,
     27216,  27217,  27219,  27220,  27225,  27226,  27228,  27229,  27243,  27244,  27246,  27247,
     27252,  27253,  27255,  27256,  27297,  27298,  27300,  27301,  27306,  27307,  27309,  27310,
     27324,  27325,  27327,  27328,  27333,  27334,  27336,  27337,  28431,  28432,  28434,  28435,
     28440,  28441,  28443,  28444,  28458,  28459,  28461,  28462,  28467,  28468,  28470,  28471,
     28512,  28513,  28515,  28516,  28521,  28522,  28524,  28525,  28539,  28540,  28542,  28543,
     28548,  28549,  28551,  28552,  28674,  28675,  28677,  28678,  28683,  28684,  28686,  28687,
     28701,  28702,  28704,  28705,  28710,  28711,  28713,  28714,  28755,  28756,  28758,  28759,
     28764,  28765,  28767,  28768,  28782,  28783,  28785,  28786,  28791,  28792,  28794,  28795,
     29160,  29161,  29163,  29164,  29169,  29170,  29172,  29173,  29187,  29188,  29190,  29191,
     29196,  29197,  29199,  29200,  29241,  29242,  29244,  29245,  29250,  29251,  29253,  29254,
     29268,  29269,  29271,  29272,  29277,  29278,  29280,  29281,  29403,  29404,  29406,  29407,
     29412,  29413,  29415,  29416,  29430,  29431,  29433,  29434,  29439,  29440,  29442,  29443,
     29484,  29485,  29487,  29488,  29493,  29494,  29496,  29497,  29511,  29512,  29514,  29515,
     29520,  29521,  29523,  29524,  59049,  59050,  59052,  59053,  59058,  59059,  59061,  59062,
     59076,  59077,  59079,  59080,  59085,  59086,  59088,  59089,  59130,  59131,  59133,  59134,
     59139,  59140,  59142,  59143,  59157,  59158,  59160,  59161,  59166,  59167,  59169,  59170,
     59292,  59293,  59295,  59296,  59301,  59302,  59304,  59305,  59319,  59320,  59322,  59323,
     59328,  59329,  59331,  59332,  59373,  59374,  59376,  59377,  59382,  59383,  59385,  59386,
     59400,  59401,  59403,  59404,  59409,  59410,  59412,  59413,  59778,  59779,  59781,  59782,
     59787,  59788,  59790,  59791,  59805,  59806,  59808,  59809,  59814,  59815,  59817,  59818,
     59859,  59860,  59862,  59863,  59868,  59869,  59871,  59872,  59886,  59887,  59889,  59890,
     59895,  59896,  59898,  59899,  60021,  60022,  60024,  60025,  60030,  60031,  60033,  60034,
     60048,  60049,  60051,  60052,  60057,  60058,  60060,  60061,  60102,  60103,  60105,  60106,
     60111,  60112,  60114,  60115,  60129,  60130,  60132,  60133,  60138,  60139,  60141,  60142,
     61236,  61237,  61239,  61240,  61245,  61246,  61248,  61249,  61263,  61264,  61266,  61267,
     61272,  61273,  61275,  61276,  61317,  61318,  61320,  61321,  61326,  61327,  61329,  61330,
     61344,  61345,  61347,  61348,  61353,  61354,  61356,  61357,  61479,  61480,  61482,  61483,
     61488,  61489,  61491,  61492,  61506,  61507,  61509,  61510,  61515,  61516,  61518,  61519,
     61560,  61561,  61563,  61564,  61569,  61570,  61572,  61573,  61587,  61588,  61590,  61591,
     61596,  61597,  61599,  61600,  61965,  61966,  61968,  61969,  61974,  61975,  61977,  61978,
     61992,  61993,  61995,  61996,  62001,  62002,  62004,  62005,  62046,  62047,  62049,  62050,
     62055,  62056,  62058,  62059,  62073,  62074,  62076,  62077,  62082,  62083,  62085,  62086,
     62208,  62209,  62211,  62212,  62217,  62218,  62220,  62221,  62235,  62236,  62238,  62239,
     62244,  62245,  62247,  62248,  62289,  62290,  62292,  62293,  62298,  62299,  62301,  62302,
     62316,  62317,  62319,  62320,  62325,  62326,  62328,  62329,  65610,  65611,  65613,  65614,
     65619,  65620,  65622,  65623,  65637,  65638,  65640,  65641,  65646,  65647,  65649,  65650,
     65691,  65692,  65694,  65695,  65700,  65701,  65703,  65704,  65718,  65719,  65721,  65722,
     65727,  65728,  65730,  65731,  65853,  65854,  65856,  65857,  65862,  65863,  65865,  65866,
     65880,  65881,  65883,  65884,  65889,  65890,  65892,  65893,  65934,  65935,  65937,  65938,
     65943,  65944,  65946,  65947,  65961,  65962,  65964,  65965,  65970,  65971,  65973,  65974,
     66339,  66340,  66342,  66343,  66348,  66349,  66351,  66352,  66366,  66367,  66369,  66370,
     66375,  66376,  66378,  66379,  66420,  66421,  66423,  66424,  66429,  66430,  66432,  66433,
     66447,  66448,  66450,  66451,  66456,  66457,  66459,  66460,  66582,  66583,  66585,  66586,
     66591,  66592,  66594,  66595,  66609,  66610,  66612,  66613,  66618,  66619,  66621,  66622,
     66663,  66664,  66666,  66667,  66672,  66673,  66675,  66676,  66690,  66691,  66693,  66694,
     66699,  66700,  66702,  66703,  67797,  67798,  67800,  67801,  67806,  67807,  67809,  67810,
     67824,  67825,  67827,  67828,  67833,  67834,  67836,  67837,  67878,  67879,  67881,  67882,
     67887,  67888,  67890,  67891,  67905,  67906,  67908,  67909,  67914,  67915,  67917,  67918,
     68040,  68041,  68043,  68044,  68049,  68050,  68052,  68053,  68067,  68068,  68070,  68071,
     68076,  68077,  68079,  68080,  68121,  68122,  68124,  68125,  68130,  68131,  68133,  68134,
     68148,  68149,  68151,  68152,  68157,  68158,  68160,  68161,  68526,  68527,  68529,  68530,
     68535,  68536,  68538,  68539,  68553,  68554,  68556,  68557,  68562,  68563,  68565,  68566,
     68607,  68608,  68610,  68611,  68616,  68617,  68619,  68620,  68634,  68635,  68637,  68638,
     68643,  68644,  68646,  68647,  68769,  68770,  68772,  68773,  68778,  68779,  68781,  68782,
     68796,  68797,  68799,  68800,  68805,  68806,  68808,  68809,  68850,  68851,  68853,  68854,
     68859,  68860,  68862,  68863,  68877,  68878,  68880,  68881,  68886,  68887,  68889,  68890,
     78732,  78733,  78735,  78736,  78741,  78742,  78744,  78745,  78759,  78760,  78762,  78763,
     78768,  78769,  78771,  78772,  78813,  78814,  78816,  78817,  78822,  78823,  78825,  78826,
     78840,  78841,  78843,  78844,  78849,  78850,  78852,  78853,  78975,  78976,  78978,  78979,
     78984,  78985,  78987,  78988,  79002,  79003,  79005,  79006,  79011,  79012,  79014,  79015,
     79056,  79057,  79059,  79060,  79065,  79066,  79068,  79069,  79083,  79084,  79086,  79087,
     79092,  79093,  79095,  79096,  79461,  79462,  79464,  79465,  79470,  79471,  79473,  79474,
     79488,  79489,  79491,  79492,  79497,  79498,  79500,  79501,  79542,  79543,  79545,  79546,
     79551,  79552,  79554,  79555,  79569,  79570,  79572,  79573,  79578,  79579,  79581,  79582,
     79704,  79705,  79707,  79708,  79713,  79714,  79716,  79717,  79731,  79732,  79734,  79735,
     79740,  79741,  79743,  79744,  79785,  79786,  79788,  79789,  79794,  79795,  79797,  79798,
     79812,  79813,  79815,  79816,  79821,  79822,  79824,  79825,  80919,  80920,  80922,  80923,
     80928,  80929,  80931,  80932,  80946,  80947,  80949,  80950,  80955,  80956,  80958,  80959,
     81000,  81001,  81003,  81004,  81009,  81010,  81012,  81013,  81027,  81028,  81030,  81031,
     81036,  81037,  81039,  81040,  81162,  81163,  81165,  81166,  81171,  81172,  81174,  81175,
     81189,  81190,  81192,  81193,  81198,  81199,  81201,  81202,  81243,  81244,  81246,  81247,
     81252,  81253,  81255,  81256,  81270,  81271,  81273,  81274,  81279,  81280,  81282,  81283,
     81648,  81649,  81651,  81652,  81657,  81658,  81660,  81661,  81675,  81676,  81678,  81679,
     81684,  81685,  81687,  81688,  81729,  81730,  81732,  81733,  81738,  81739,  81741,  81742,
     81756,  81757,  81759,  81760,  81765,  81766,  81768,  81769,  81891,  81892,  81894,  81895,
     81900,  81901,  81903,  81904,  81918,  81919,  81921,  81922,  81927,  81928,  81930,  81931,
     81972,  81973,  81975,  81976,  81981,  81982,  81984,  81985,  81999,  82000,  82002,  82003,
     82008,  82009,  82011,  82012,  85293,  85294,  85296,  85297,  85302,  85303,  85305,  85306,
     85320,  85321,  85323,  85324,  85329,  85330,  85332,  85333,  85374,  85375,  85377,  85378,
     85383,  85384,  85386,  85387,  85401,  85402,  85404,  85405,  85410,  85411,  85413,  85414,
     85536,  85537,  85539,  85540,  85545,  85546,  85548,  85549,  85563,  85564,  85566,  85567,
     85572,  85573,  85575,  85576,  85617,  85618,  85620,  85621,  85626,  85627,  85629,  85630,
     85644,  85645,  85647,  85648,  85653,  85654,  85656,  85657,  86022,  86023,  86025,  86026,
     86031,  86032,  86034,  86035,  86049,  86050,  86052,  86053,  86058,  86059,  86061,  86062,
     86103,  86104,  86106,  86107,  86112,  86113,  86115,  86116,  86130,  86131,  86133,  86134,
     86139,  86140,  86142,  86143,  86265,  86266,  86268,  86269,  86274,  86275,  86277,  86278,
     86292,  86293,  86295,  86296,  86301,  86302,  86304,  86305,  86346,  86347,  86349,  86350,
     86355,  86356,  86358,  86359,  86373,  86374,  86376,  86377,  86382,  86383,  86385,  86386,
     87480,  87481,  87483,  87484,  87489,  87490,  87492,  87493,  87507,  87508,  87510,  87511,
     87516,  87517,  87519,  87520,  87561,  87562,  87564,  87565,  87570,  87571,  87573,  87574,
     87588,  87589,  87591,  87592,  87597,  87598,  87600,  87601,  87723,  87724,  87726,  87727,
     87732,  87733,  87735,  87736,  87750,  87751,  87753,  87754,  87759,  87760,  87762,  87763,
     87804,  87805,  87807,  87808,  87813,  87814,  87816,  87817,  87831,  87832,  87834,  87835,
     87840,  87841,  87843,  87844,  88209,  88210,  88212,  88213,  88218,  88219,  88221,  88222,
     88236,  88237,  88239,  88240,  88245,  88246,  88248,  88249,  88290,  88291,  88293,  88294,
     88299,  88300,  88302,  88303,  88317,  88318,  88320,  88321,  88326,  88327,  88329,  88330,
     88452,  88453,  88455,  88456,  88461,  88462,  88464,  88465,  88479,  88480,  88482,  88483,
     88488,  88489,  88491,  88492,  88533,  88534,  88536,  88537,  88542,  88543,  88545,  88546,
     88560,  88561,  88563,  88564,  88569,  88570,  88572,  88573, 177147, 177148, 177150, 177151,
    177156, 177157, 177159, 177160, 177174, 177175, 177177, 177178, 177183, 177184, 177186, 177187,
    177228, 177229, 177231, 177232, 177237, 177238, 177240, 177241, 177255, 177256, 177258, 177259,
    177264, 177265, 177267, 177268, 177390, 177391, 177393, 177394, 177399, 177400, 177402, 177403,
    177417, 177418, 177420, 177421, 177426, 177427, 177429, 177430, 177471, 177472, 177474, 177475,
    177480, 177481, 177483, 177484, 177498, 177499, 177501, 177502, 177507, 177508, 177510, 177511,
    177876, 177877, 177879, 177880, 177885, 177886, 177888, 177889, 177903, 177904, 177906, 177907,
    177912, 177913, 177915, 177916, 177957, 177958, 177960, 177961, 177966, 177967, 177969, 177970,
    177984, 177985, 177987, 177988, 177993, 177994, 177996, 177997, 178119, 178120, 178122, 178123,
    178128, 178129, 178131, 178132, 178146, 178147, 178149, 178150, 178155, 178156, 178158, 178159,
    178200, 178201, 178203, 178204, 178209, 178210, 178212, 178213, 178227, 178228, 178230, 178231,
    178236, 178237, 178239, 178240, 179334, 179335, 179337, 179338, 179343, 179344, 179346, 179347,
    179361, 179362, 179364, 179365, 179370, 179371, 179373, 179374, 179415, 179416, 179418, 179419,
    179424, 179425, 179427, 179428, 179442, 179443, 179445, 179446, 179451, 179452, 179454, 179455,
    179577, 179578, 179580, 179581, 179586, 179587, 179589, 179590, 179604, 179605, 179607, 179608,
    179613, 179614, 179616, 179617, 179658, 179659, 179661, 179662, 179667, 179668, 179670, 179671,
    179685, 179686, 179688, 179689, 179694, 179695, 179697, 179698, 180063, 180064, 180066, 180067,
    180072, 180073, 180075, 180076, 180090, 180091, 180093, 180094, 180099, 180100, 180102, 180103,
    180144, 180145, 180147, 180148, 180153, 180154, 180156, 180157, 180171, 180172, 180174, 180175,
    180180, 180181, 180183, 180184, 180306, 180307, 180309, 180310, 180315, 180316, 180318, 180319,
    180333, 180334, 180336, 180337, 180342, 180343, 180345, 180346, 180387, 180388, 180390, 180391,
    180396, 180397, 180399, 180400, 180414, 180415, 180417, 180418, 180423, 180424, 180426, 180427,
    183708, 183709, 183711, 183712, 183717, 183718, 183720, 183721, 183735, 183736, 183738, 183739,
    183744, 183745, 183747, 183748, 183789, 183790, 183792, 183793, 183798, 183799, 183801, 183802,
    183816, 183817, 183819, 183820, 183825, 183826, 183828, 183829, 183951, 183952, 183954, 183955,
    183960, 183961, 183963, 183964, 183978, 183979, 183981, 183982, 183987, 183988, 183990, 183991,
    184032, 184033, 184035, 184036, 184041, 184042, 184044, 184045, 184059, 184060, 184062, 184063,
    184068, 184069, 184071, 184072, 184437, 184438, 184440, 184441, 184446, 184447, 184449, 184450,
    184464, 184465, 184467, 184468, 184473, 184474, 184476, 184477, 184518, 184519, 184521, 184522,
    184527, 184528, 184530, 184531, 184545, 184546, 184548, 184549, 184554, 184555, 184557, 184558,
    184680, 184681, 184683, 184684, 184689, 184690, 184692, 184693, 184707, 184708, 184710, 184711,
    184716, 184717, 184719, 184720, 184761, 184762, 184764, 184765, 184770, 184771, 184773, 184774,
    184788, 184789, 184791, 184792, 184797, 184798, 184800, 184801, 185895, 185896, 185898, 185899,
    185904, 185905, 185907, 185908, 185922, 185923, 185925, 185926, 185931, 185932, 185934, 185935,
    185976, 185977, 185979, 185980, 185985, 185986, 185988, 185989, 186003, 186004, 186006, 186007,
    186012, 186013, 186015, 186016, 186138, 186139, 186141, 186142, 186147, 186148, 186150, 186151,
    186165, 186166, 186168, 186169, 186174, 186175, 186177, 186178, 186219, 186220, 186222, 186223,
    186228, 186229, 186231, 186232, 186246, 186247, 186249, 186250, 186255, 186256, 186258, 186259,
    186624, 186625, 186627, 186628, 186633, 186634, 186636, 186637, 186651, 186652, 186654, 186655,
    186660, 186661, 186663, 186664, 186705, 186706, 186708, 186709, 186714, 186715, 186717, 186718,
    186732, 186733, 186735, 186736, 186741, 186742, 186744, 186745, 186867, 186868, 186870, 186871,
    186876, 186877, 186879, 186880, 186894, 186895, 186897, 186898, 186903, 186904, 186906, 186907,
    186948, 186949, 186951, 186952, 186957, 186958, 186960, 186961, 186975, 186976, 186978, 186979,
    186984, 186985, 186987, 186988, 196830, 196831, 196833, 196834, 196839, 196840, 196842, 196843,
    196857, 196858, 196860, 196861, 196866, 196867, 196869, 196870, 196911, 196912, 196914, 196915,
    196920, 196921, 196923, 196924, 196938, 196939, 196941, 196942, 196947, 196948, 196950, 196951,
    197073, 197074, 197076, 197077, 197082, 197083, 197085, 197086, 197100, 197101, 197103, 197104,
    197109, 197110, 197112, 197113, 197154, 197155, 197157, 197158, 197163, 197164, 197166, 197167,
    197181, 197182, 197184, 197185, 197190, 197191, 197193, 197194, 197559, 197560, 197562, 197563,
    197568, 197569, 197571, 197572, 197586, 197587, 197589, 197590, 197595, 197596, 197598, 197599,
    197640, 197641, 197643, 197644, 197649, 197650, 197652, 197653, 197667, 197668, 197670, 197671,
    197676, 197677, 197679, 197680, 197802, 197803, 197805, 197806, 197811, 197812, 197814, 197815,
    197829, 197830, 197832, 197833, 197838, 197839, 197841, 197842, 197883, 197884, 197886, 197887,
    197892, 197893, 197895, 197896, 197910, 197911, 197913, 197914, 197919, 197920, 197922, 197923,
    199017, 199018, 199020, 199021, 199026, 199027, 199029, 199030, 199044, 199045, 199047, 199048,
    199053, 199054, 199056, 199057, 199098, 199099, 199101, 199102, 199107, 199108, 199110, 199111,
    199125, 199126, 199128, 199129, 199134, 199135, 199137, 199138, 199260, 199261, 199263, 199264,
    199269, 199270, 199272, 199273, 199287, 199288, 199290, 199291, 199296, 199297, 199299, 199300,
    199341, 199342, 199344, 199345, 199350, 199351, 199353, 199354, 199368, 199369, 199371, 199372,
    199377, 199378, 199380, 199381, 199746, 199747, 199749, 199750, 199755, 199756, 199758, 199759,
    199773, 199774, 199776, 199777, 199782, 199783, 199785, 199786, 199827, 199828, 199830, 199831,
    199836, 199837, 199839, 199840, 199854, 199855, 199857, 199858, 199863, 199864, 199866, 199867,
    199989, 199990, 199992, 199993, 199998, 199999, 200001, 200002, 200016, 200017, 200019, 200020,
    200025, 200026, 200028, 200029, 200070, 200071, 200073, 200074, 200079, 200080, 200082, 200083,
    200097, 200098, 200100, 200101, 200106, 200107, 200109, 200110, 203391, 203392, 203394, 203395,
    203400, 203401, 203403, 203404, 203418, 203419, 203421, 203422, 203427, 203428, 203430, 203431,
    203472, 203473, 203475, 203476, 203481, 203482, 203484, 203485, 203499, 203500, 203502, 203503,
    203508, 203509, 203511, 203512, 203634, 203635, 203637, 203638, 203643, 203644, 203646, 203647,
    203661, 203662, 203664, 203665, 203670, 203671, 203673, 203674, 203715, 203716, 203718, 203719,
    203724, 203725, 203727, 203728, 203742, 203743, 203745, 203746, 203751, 203752, 203754, 203755,
    204120, 204121, 204123, 204124, 204129, 204130, 204132, 204133, 204147, 204148, 204150, 204151,
    204156, 204157, 204159, 204160, 204201, 204202, 204204, 204205, 204210, 204211, 204213, 204214,
    204228, 204229, 204231, 204232, 204237, 204238, 204240, 204241, 204363, 204364, 204366, 204367,
    204372, 204373, 204375, 204376, 204390, 204391, 204393, 204394, 204399, 204400, 204402, 204403,
    204444, 204445, 204447, 204448, 204453, 204454, 204456, 204457, 204471, 204472, 204474, 204475,
    204480, 204481, 204483, 204484, 205578, 205579, 205581, 205582, 205587, 205588, 205590, 205591,
    205605, 205606, 205608, 205609, 205614, 205615, 205617, 205618, 205659, 205660, 205662, 205663,
    205668, 205669, 205671, 205672, 205686, 205687, 205689, 205690, 205695, 205696, 205698, 205699,
    205821, 205822, 205824, 205825, 205830, 205831, 205833, 205834, 205848, 205849, 205851, 205852,
    205857, 205858, 205860, 205861, 205902, 205903, 205905, 205906, 205911, 205912, 205914, 205915,
    205929, 205930, 205932, 205933, 205938, 205939, 205941, 205942, 206307, 206308, 206310, 206311,
    206316, 206317, 206319, 206320, 206334, 206335, 206337, 206338, 206343, 206344, 206346, 206347,
    206388, 206389, 206391, 206392, 206397, 206398, 206400, 206401, 206415, 206416, 206418, 206419,
    206424, 206425, 206427, 206428, 206550, 206551, 206553, 206554, 206559, 206560, 206562, 206563,
    206577, 206578, 206580, 206581, 206586, 206587, 206589, 206590, 206631, 206632, 206634, 206635,
    206640, 206641, 206643, 206644, 206658, 206659, 206661, 206662, 206667, 206668, 206670, 206671,
    236196, 236197, 236199, 236200, 236205, 236206, 236208, 236209, 236223, 236224, 236226, 236227,
    236232, 236233, 236235, 236236, 236277, 236278, 236280, 236281, 236286, 236287, 236289, 236290,
    236304, 236305, 236307, 236308, 236313, 236314, 236316, 236317, 236439, 236440, 236442, 236443,
    236448, 236449, 236451, 236452, 236466, 236467, 236469, 236470, 236475, 236476, 236478, 236479,
    236520, 236521, 236523, 236524, 236529, 236530, 236532, 236533, 236547, 236548, 236550, 236551,
    236556, 236557, 236559, 236560, 236925, 236926, 236928, 236929, 236934, 236935, 236937, 236938,
    236952, 236953, 236955, 236956, 236961, 236962, 236964, 236965, 237006, 237007, 237009, 237010,
    237015, 237016, 237018, 237019, 237033, 237034, 237036, 237037, 237042, 237043, 237045, 237046,
    237168, 237169, 237171, 237172, 237177, 237178, 237180, 237181, 237195, 237196, 237198, 237199,
    237204, 237205, 237207, 237208, 237249, 237250, 237252, 237253, 237258, 237259, 237261, 237262,
    237276, 237277, 237279, 237280, 237285, 237286, 237288, 237289, 238383, 238384, 238386, 238387,
    238392, 238393, 238395, 238396, 238410, 238411, 238413, 238414, 238419, 238420, 238422, 238423,
    238464, 238465, 238467, 238468, 238473, 238474, 238476, 238477, 238491, 238492, 238494, 238495,
    238500, 238501, 238503, 238504, 238626, 238627, 238629, 238630, 238635, 238636, 238638, 238639,
    238653, 238654, 238656, 238657, 238662, 238663, 238665, 238666, 238707, 238708, 238710, 238711,
    238716, 238717, 238719, 238720, 238734, 238735, 238737, 238738, 238743, 238744, 238746, 238747,
    239112, 239113, 239115, 239116, 239121, 239122, 239124, 239125, 239139, 239140, 239142, 239143,
    239148, 239149, 239151, 239152, 239193, 239194, 239196, 239197, 239202, 239203, 239205, 239206,
    239220, 239221, 239223, 239224, 239229, 239230, 239232, 239233, 239355, 239356, 239358, 239359,
    239364, 239365, 239367, 239368, 239382, 239383, 239385, 239386, 239391, 239392, 239394, 239395,
    239436, 239437, 239439, 239440, 239445, 239446, 239448, 239449, 239463, 239464, 239466, 239467,
    239472, 239473, 239475, 239476, 242757, 242758, 242760, 242761, 242766, 242767, 242769, 242770,
    242784, 242785, 242787, 242788, 242793, 242794, 242796, 242797, 242838, 242839, 242841, 242842,
    242847, 242848, 242850, 242851, 242865, 242866, 242868, 242869, 242874, 242875, 242877, 242878,
    243000, 243001, 243003, 243004, 243009, 243010, 243012, 243013, 243027, 243028, 243030, 243031,
    243036, 243037, 243039, 243040, 243081, 243082, 243084, 243085, 243090, 243091, 243093, 243094,
    243108, 243109, 243111, 243112, 243117, 243118, 243120, 243121, 243486, 243487, 243489, 243490,
    243495, 243496, 243498, 243499, 243513, 243514, 243516, 243517, 243522, 243523, 243525, 243526,
    243567, 243568, 243570, 243571, 243576, 243577, 243579, 243580, 243594, 243595, 243597, 243598,
    243603, 243604, 243606, 243607, 243729, 243730, 243732, 243733, 243738, 243739, 243741, 243742,
    243756, 243757, 243759, 243760, 243765, 243766, 243768, 243769, 243810, 243811, 243813, 243814,
    243819, 243820, 243822, 243823, 243837, 243838, 243840, 243841, 243846, 243847, 243849, 243850,
    244944, 244945, 244947, 244948, 244953, 244954, 244956, 244957, 244971, 244972, 244974, 244975,
    244980, 244981, 244983, 244984, 245025, 245026, 245028, 245029, 245034, 245035, 245037, 245038,
    245052, 245053, 245055, 245056, 245061, 245062, 245064, 245065, 245187, 245188, 245190, 245191,
    245196, 245197, 245199, 245200, 245214, 245215, 245217, 245218, 245223, 245224, 245226, 245227,
    245268, 245269, 245271, 245272, 245277, 245278, 245280, 245281, 245295, 245296, 245298, 245299,
    245304, 245305, 245307, 245308, 245673, 245674, 245676, 245677, 245682, 245683, 245685, 245686,
    245700, 245701, 245703, 245704, 245709, 245710, 245712, 245713, 245754, 245755, 245757, 245758,
    245763, 245764, 245766, 245767, 245781, 245782, 245784, 245785, 245790, 245791, 245793, 245794,
    245916, 245917, 245919, 245920, 245925, 245926, 245928, 245929, 245943, 245944, 245946, 245947,
    245952, 245953, 245955, 245956, 245997, 245998, 246000, 246001, 246006, 246007, 246009, 246010,
    246024, 246025, 246027, 246028, 246033, 246034, 246036, 246037, 255879, 255880, 255882, 255883,
    255888, 255889, 255891, 255892, 255906, 255907, 255909, 255910, 255915, 255916, 255918, 255919,
    255960, 255961, 255963, 255964, 255969, 255970, 255972, 255973, 255987, 255988, 255990, 255991,
    255996, 255997, 255999, 256000, 256122, 256123, 256125, 256126, 256131, 256132, 256134, 256135,
    256149, 256150, 256152, 256153, 256158, 256159, 256161, 256162, 256203, 256204, 256206, 256207,
    256212, 256213, 256215, 256216, 256230, 256231, 256233, 256234, 256239, 256240, 256242, 256243,
    256608, 256609, 256611, 256612, 256617, 256618, 256620, 256621, 256635, 256636, 256638, 256639,
    256644, 256645, 256647, 256648, 256689, 256690, 256692, 256693, 256698, 256699, 256701, 256702,
    256716, 256717, 256719, 256720, 256725, 256726, 256728, 256729, 256851, 256852, 256854, 256855,
    256860, 256861, 256863, 256864, 256878, 256879, 256881, 256882, 256887, 256888, 256890, 256891,
    256932, 256933, 256935, 256936, 256941, 256942, 256944, 256945, 256959, 256960, 256962, 256963,
    256968, 256969, 256971, 256972, 258066, 258067, 258069, 258070, 258075, 258076, 258078, 258079,
    258093, 258094, 258096, 258097, 258102, 258103, 258105, 258106, 258147, 258148, 258150, 258151,
    258156, 258157, 258159, 258160, 258174, 258175, 258177, 258178, 258183, 258184, 258186, 258187,
    258309, 258310, 258312, 258313, 258318, 258319, 258321, 258322, 258336, 258337, 258339, 258340,
    258345, 258346, 258348, 258349, 258390, 258391, 258393, 258394, 258399, 258400, 258402, 258403,
    258417, 258418, 258420, 258421, 258426, 258427, 258429, 258430, 258795, 258796, 258798, 258799,
    258804, 258805, 258807, 258808, 258822, 258823, 258825, 258826, 258831, 258832, 258834, 258835,
    258876, 258877, 258879, 258880, 258885, 258886, 258888, 258889, 258903, 258904, 258906, 258907,
    258912, 258913, 258915, 258916, 259038, 259039, 259041, 259042, 259047, 259048, 259050, 259051,
    259065, 259066, 259068, 259069, 259074, 259075, 259077, 259078, 259119, 259120, 259122, 259123,
    259128, 259129, 259131, 259132, 259146, 259147, 259149, 259150, 259155, 259156, 259158, 259159,
    262440, 262441, 262443, 262444, 262449, 262450, 262452, 262453, 262467, 262468, 262470, 262471,
    262476, 262477, 262479, 262480, 262521, 262522, 262524, 262525, 262530, 262531, 262533, 262534,
    262548, 262549, 262551, 262552, 262557, 262558, 262560, 262561, 262683, 262684, 262686, 262687,
    262692, 262693, 262695, 262696, 262710, 262711, 262713, 262714, 262719, 262720, 262722, 262723,
    262764, 262765, 262767, 262768, 262773, 262774, 262776, 262777, 262791, 262792, 262794, 262795,
    262800, 262801, 262803, 262804, 263169, 263170, 263172, 263173, 263178, 263179, 263181, 263182,
    263196, 263197, 263199, 263200, 263205, 263206, 263208, 263209, 263250, 263251, 263253, 263254,
    263259, 263260, 263262, 263263, 263277, 263278, 263280, 263281, 263286, 263287, 263289, 263290,
    263412, 263413, 263415, 263416, 263421, 263422, 263424, 263425, 263439, 263440, 263442, 263443,
    263448, 263449, 263451, 263452, 263493, 263494, 263496, 263497, 263502, 263503, 263505, 263506,
    263520, 263521, 263523, 263524, 263529, 263530, 263532, 263533, 264627, 264628, 264630, 264631,
    264636, 264637, 264639, 264640, 264654, 264655, 264657, 264658, 264663, 264664, 264666, 264667,
    264708, 264709, 264711, 264712, 264717, 264718, 264720, 264721, 264735, 264736, 264738, 264739,
    264744, 264745, 264747, 264748, 264870, 264871, 264873, 264874, 264879, 264880, 264882, 264883,
    264897, 264898, 264900, 264901, 264906, 264907, 264909, 264910, 264951, 264952, 264954, 264955,
    264960, 264961, 264963, 264964, 264978, 264979, 264981, 264982, 264987, 264988, 264990, 264991,
    265356, 265357, 265359, 265360, 265365, 265366, 265368, 265369, 265383, 265384, 265386, 265387,
    265392, 265393, 265395, 265396, 265437, 265438, 265440, 265441, 265446, 265447, 265449, 265450,
    265464, 265465, 265467, 265468, 265473, 265474, 265476, 265477, 265599, 265600, 265602, 265603,
    265608, 265609, 265611, 265612, 265626, 265627, 265629, 265630, 265635, 265636, 265638, 265639,
    265680, 265681, 265683, 265684, 265689, 265690, 265692, 265693, 265707, 265708, 265710, 265711,
    265716, 265717, 265719, 265720,
];

const TWOS_TERNARY: [usize; 4096] = [
         0,      2,      6,      8,     18,     20,     24,     26,     54,     56,     60,     62,
        72,     74,     78,     80,    162,    164,    168,    170,    180,    182,    186,    188,
       216,    218,    222,    224,    234,    236,    240,    242,    486,    488,    492,    494,
       504,    506,    510,    512,    540,    542,    546,    548,    558,    560,    564,    566,
       648,    650,    654,    656,    666,    668,    672,    674,    702,    704,    708,    710,
       720,    722,    726,    728,   1458,   1460,   1464,   1466,   1476,   1478,   1482,   1484,
      1512,   1514,   1518,   1520,   1530,   1532,   1536,   1538,   1620,   1622,   1626,   1628,
      1638,   1640,   1644,   1646,   1674,   1676,   1680,   1682,   1692,   1694,   1698,   1700,
      1944,   1946,   1950,   1952,   1962,   1964,   1968,   1970,   1998,   2000,   2004,   2006,
      2016,   2018,   2022,   2024,   2106,   2108,   2112,   2114,   2124,   2126,   2130,   2132,
      2160,   2162,   2166,   2168,   2178,   2180,   2184,   2186,   4374,   4376,   4380,   4382,
      4392,   4394,   4398,   4400,   4428,   4430,   4434,   4436,   4446,   4448,   4452,   4454,
      4536,   4538,   4542,   4544,   4554,   4556,   4560,   4562,   4590,   4592,   4596,   4598,
      4608,   4610,   4614,   4616,   4860,   4862,   4866,   4868,   4878,   4880,   4884,   4886,
      4914,   4916,   4920,   4922,   4932,   4934,   4938,   4940,   5022,   5024,   5028,   5030,
      5040,   5042,   5046,   5048,   5076,   5078,   5082,   5084,   5094,   5096,   5100,   5102,
      5832,   5834,   5838,   5840,   5850,   5852,   5856,   5858,   5886,   5888,   5892,   5894,
      5904,   5906,   5910,   5912,   5994,   5996,   6000,   6002,   6012,   6014,   6018,   6020,
      6048,   6050,   6054,   6056,   6066,   6068,   6072,   6074,   6318,   6320,   6324,   6326,
      6336,   6338,   6342,   6344,   6372,   6374,   6378,   6380,   6390,   6392,   6396,   6398,
      6480,   6482,   6486,   6488,   6498,   6500,   6504,   6506,   6534,   6536,   6540,   6542,
      6552,   6554,   6558,   6560,  13122,  13124,  13128,  13130,  13140,  13142,  13146,  13148,
     13176,  13178,  13182,  13184,  13194,  13196,  13200,  13202,  13284,  13286,  13290,  13292,
     13302,  13304,  13308,  13310,  13338,  13340,  13344,  13346,  13356,  13358,  13362,  13364,
     13608,  13610,  13614,  13616,  13626,  13628,  13632,  13634,  13662,  13664,  13668,  13670,
     13680,  13682,  13686,  13688,  13770,  13772,  13776,  13778,  13788,  13790,  13794,  13796,
     13824,  13826,  13830,  13832,  13842,  13844,  13848,  13850,  14580,  14582,  14586,  14588,
     14598,  14600,  14604,  14606,  14634,  14636,  14640,  14642,  14652,  14654,  14658,  14660,
     14742,  14744,  14748,  14750,  14760,  14762,  14766,  14768,  14796,  14798,  14802,  14804,
     14814,  14816,  14820,  14822,  15066,  15068,  15072,  15074,  15084,  15086,  15090,  15092,
     15120,  15122,  15126,  15128,  15138,  15140,  15144,  15146,  15228,  15230,  15234,  15236,
     15246,  15248,  15252,  15254,  15282,  15284,  15288,  15290,  15300,  15302,  15306,  15308,
     17496,  17498,  17502,  17504,  17514,  17516,  17520,  17522,  17550,  17552,  17556,  17558,
     17568,  17570,  17574,  17576,  17658,  17660,  17664,  17666,  17676,  17678,  17682,  17684,
     17712,  17714,  17718,  17720,  17730,  17732,  17736,  17738,  17982,  17984,  17988,  17990,
     18000,  18002,  18006,  18008,  18036,  18038,  18042,  18044,  18054,  18056,  18060,  18062,
     18144,  18146,  18150,  18152,  18162,  18164,  18168,  18170,  18198,  18200,  18204,  18206,
     18216,  18218,  18222,  18224,  18954,  18956,  18960,  18962,  18972,  18974,  18978,  18980,
     19008,  19010,  19014,  19016,  19026,  19028,  19032,  19034,  19116,  19118,  19122,  19124,
     19134,  19136,  19140,  19142,  19170,  19172,  19176,  19178,  19188,  19190,  19194,  19196,
     19440,  19442,  19446,  19448,  19458,  19460,  19464,  19466,  19494,  19496,  19500,  19502,
     19512,  19514,  19518,  19520,  19602,  19604,  19608,  19610,  19620,  19622,  19626,  19628,
     19656,  19658,  19662,  19664,  19674,  19676,  19680,  19682,  39366,  39368,  39372,  39374,
     39384,  39386,  39390,  39392,  39420,  39422,  39426,  39428,  39438,  39440,  39444,  39446,
     39528,  39530,  39534,  39536,  39546,  39548,  39552,  39554,  39582,  39584,  39588,  39590,
     39600,  39602,  39606,  39608,  39852,  39854,  39858,  39860,  39870,  39872,  39876,  39878,
     39906,  39908,  39912,  39914,  39924,  39926,  39930,  39932,  40014,  40016,  40020,  40022,
     40032,  40034,  40038,  40040,  40068,  40070,  40074,  40076,  40086,  40088,  40092,  40094,
     40824,  40826,  40830,  40832,  40842,  40844,  40848,  40850,  40878,  40880,  40884,  40886,
     40896,  40898,  40902,  40904,  40986,  40988,  40992,  40994,  41004,  41006,  41010,  41012,
     41040,  41042,  41046,  41048,  41058,  41060,  41064,  41066,  41310,  41312,  41316,  41318,
     41328,  41330,  41334,  41336,  41364,  41366,  41370,  41372,  41382,  41384,  41388,  41390,
     41472,  41474,  41478,  41480,  41490,  41492,  41496,  41498,  41526,  41528,  41532,  41534,
     41544,  41546,  41550,  41552,  43740,  43742,  43746,  43748,  43758,  43760,  43764,  43766,
     43794,  43796,  43800,  43802,  43812,  43814,  43818,  43820,  43902,  43904,  43908,  43910,
     43920,  43922,  43926,  43928,  43956,  43958,  43962,  43964,  43974,  43976,  43980,  43982,
     44226,  44228,  44232,  44234,  44244,  44246,  44250,  44252,  44280,  44282,  44286,  44288,
     44298,  44300,  44304,  44306,  44388,  44390,  44394,  44396,  44406,  44408,  44412,  44414,
     44442,  44444,  44448,  44450,  44460,  44462,  44466,  44468,  45198,  45200,  45204,  45206,
     45216,  45218,  45222,  45224,  45252,  45254,  45258,  45260,  45270,  45272,  45276,  45278,
     45360,  45362,  45366,  45368,  45378,  45380,  45384,  45386,  45414,  45416,  45420,  45422,
     45432,  45434,  45438,  45440,  45684,  45686,  45690,  45692,  45702,  45704,  45708,  45710,
     45738,  45740,  45744,  45746,  45756,  45758,  45762,  45764,  45846,  45848,  45852,  45854,
     45864,  45866,  45870,  45872,  45900,  45902,  45906,  45908,  45918,  45920,  45924,  45926,
     52488,  52490,  52494,  52496,  52506,  52508,  52512,  52514,  52542,  52544,  52548,  52550,
     52560,  52562,  52566,  52568,  52650,  52652,  52656,  52658,  52668,  52670,  52674,  52676,
     52704,  52706,  52710,  52712,  52722,  52724,  52728,  52730,  52974,  52976,  52980,  52982,
     52992,  52994,  52998,  53000,  53028,  53030,  53034,  53036,  53046,  53048,  53052,  53054,
     53136,  53138,  53142,  53144,  53154,  53156,  53160,  53162,  53190,  53192,  53196,  53198,
     53208,  53210,  53214,  53216,  53946,  53948,  53952,  53954,  53964,  53966,  53970,  53972,
     54000,  54002,  54006,  54008,  54018,  54020,  54024,  54026,  54108,  54110,  54114,  54116,
     54126,  54128,  54132,  54134,  54162,  54164,  54168,  54170,  54180,  54182,  54186,  54188,
     54432,  54434,  54438,  54440,  54450,  54452,  54456,  54458,  54486,  54488,  54492,  54494,
     54504,  54506,  54510,  54512,  54594,  54596,  54600,  54602,  54612,  54614,  54618,  54620,
     54648,  54650,  54654,  54656,  54666,  54668,  54672,  54674,  56862,  56864,  56868,  56870,
     56880,  56882,  56886,  56888,  56916,  56918,  56922,  56924,  56934,  56936,  56940,  56942,
     57024,  57026,  57030,  57032,  57042,  57044,  57048,  57050,  57078,  57080,  57084,  57086,
     57096,  57098,  57102,  57104,  57348,  57350,  57354,  57356,  57366,  57368,  57372,  57374,
     57402,  57404,  57408,  57410,  57420,  57422,  57426,  57428,  57510,  57512,  57516,  57518,
     57528,  57530,  57534,  57536,  57564,  57566,  57570,  57572,  57582,  57584,  57588,  57590,
     58320,  58322,  58326,  58328,  58338,  58340,  58344,  58346,  58374,  58376,  58380,  58382,
     58392,  58394,  58398,  58400,  58482,  58484,  58488,  58490,  58500,  58502,  58506,  58508,
     58536,  58538,  58542,  58544,  58554,  58556,  58560,  58562,  58806,  58808,  58812,  58814,
     58824,  58826,  58830,  58832,  58860,  58862,  58866,  58868,  58878,  58880,  58884,  58886,
     58968,  58970,  58974,  58976,  58986,  58988,  58992,  58994,  59022,  59024,  59028,  59030,
     59040,  59042,  59046,  59048, 118098, 118100, 118104, 118106, 118116, 118118, 118122, 118124,
    118152, 118154, 118158, 118160, 118170, 118172, 118176, 118178, 118260, 118262, 118266, 118268,
    118278, 118280, 118284, 118286, 118314, 118316, 118320, 118322, 118332, 118334, 118338, 118340,
    118584, 118586, 118590, 118592, 118602, 118604, 118608, 118610, 118638, 118640, 118644, 118646,
    118656, 118658, 118662, 118664, 118746, 118748, 118752, 118754, 118764, 118766, 118770, 118772,
    118800, 118802, 118806, 118808, 118818, 118820, 118824, 118826, 119556, 119558, 119562, 119564,
    119574, 119576, 119580, 119582, 119610, 119612, 119616, 119618, 119628, 119630, 119634, 119636,
    119718, 119720, 119724, 119726, 119736, 119738, 119742, 119744, 119772, 119774, 119778, 119780,
    119790, 119792, 119796, 119798, 120042, 120044, 120048, 120050, 120060, 120062, 120066, 120068,
    120096, 120098, 120102, 120104, 120114, 120116, 120120, 120122, 120204, 120206, 120210, 120212,
    120222, 120224, 120228, 120230, 120258, 120260, 120264, 120266, 120276, 120278, 120282, 120284,
    122472, 122474, 122478, 122480, 122490, 122492, 122496, 122498, 122526, 122528, 122532, 122534,
    122544, 122546, 122550, 122552, 122634, 122636, 122640, 122642, 122652, 122654, 122658, 122660,
    122688, 122690, 122694, 122696, 122706, 122708, 122712, 122714, 122958, 122960, 122964, 122966,
    122976, 122978, 122982, 122984, 123012, 123014, 123018, 123020, 123030, 123032, 123036, 123038,
    123120, 123122, 123126, 123128, 123138, 123140, 123144, 123146, 123174, 123176, 123180, 123182,
    123192, 123194, 123198, 123200, 123930, 123932, 123936, 123938, 123948, 123950, 123954, 123956,
    123984, 123986, 123990, 123992, 124002, 124004, 124008, 124010, 124092, 124094, 124098, 124100,
    124110, 124112, 124116, 124118, 124146, 124148, 124152, 124154, 124164, 124166, 124170, 124172,
    124416, 124418, 124422, 124424, 124434, 124436, 124440, 124442, 124470, 124472, 124476, 124478,
    124488, 124490, 124494, 124496, 124578, 124580, 124584, 124586, 124596, 124598, 124602, 124604,
    124632, 124634, 124638, 124640, 124650, 124652, 124656, 124658, 131220, 131222, 131226, 131228,
    131238, 131240, 131244, 131246, 131274, 131276, 131280, 131282, 131292, 131294, 131298, 131300,
    131382, 131384, 131388, 131390, 131400, 131402, 131406, 131408, 131436, 131438, 131442, 131444,
    131454, 131456, 131460, 131462, 131706, 131708, 131712, 131714, 131724, 131726, 131730, 131732,
    131760, 131762, 131766, 131768, 131778, 131780, 131784, 131786, 131868, 131870, 131874, 131876,
    131886, 131888, 131892, 131894, 131922, 131924, 131928, 131930, 131940, 131942, 131946, 131948,
    132678, 132680, 132684, 132686, 132696, 132698, 132702, 132704, 132732, 132734, 132738, 132740,
    132750, 132752, 132756, 132758, 132840, 132842, 132846, 132848, 132858, 132860, 132864, 132866,
    132894, 132896, 132900, 132902, 132912, 132914, 132918, 132920, 133164, 133166, 133170, 133172,
    133182, 133184, 133188, 133190, 133218, 133220, 133224, 133226, 133236, 133238, 133242, 133244,
    133326, 133328, 133332, 133334, 133344, 133346, 133350, 133352, 133380, 133382, 133386, 133388,
    133398, 133400, 133404, 133406, 135594, 135596, 135600, 135602, 135612, 135614, 135618, 135620,
    135648, 135650, 135654, 135656, 135666, 135668, 135672, 135674, 135756, 135758, 135762, 135764,
    135774, 135776, 135780, 135782, 135810, 135812, 135816, 135818, 135828, 135830, 135834, 135836,
    136080, 136082, 136086, 136088, 136098, 136100, 136104, 136106, 136134, 136136, 136140, 136142,
    136152, 136154, 136158, 136160, 136242, 136244, 136248, 136250, 136260, 136262, 136266, 136268,
    136296, 136298, 136302, 136304, 136314, 136316, 136320, 136322, 137052, 137054, 137058, 137060,
    137070, 137072, 137076, 137078, 137106, 137108, 137112, 137114, 137124, 137126, 137130, 137132,
    137214, 137216, 137220, 137222, 137232, 137234, 137238, 137240, 137268, 137270, 137274, 137276,
    137286, 137288, 137292, 137294, 137538, 137540, 137544, 137546, 137556, 137558, 137562, 137564,
    137592, 137594, 137598, 137600, 137610, 137612, 137616, 137618, 137700, 137702, 137706, 137708,
    137718, 137720, 137724, 137726, 137754, 137756, 137760, 137762, 137772, 137774, 137778, 137780,
    157464, 157466, 157470, 157472, 157482, 157484, 157488, 157490, 157518, 157520, 157524, 157526,
    157536, 157538, 157542, 157544, 157626, 157628, 157632, 157634, 157644, 157646, 157650, 157652,
    157680, 157682, 157686, 157688, 157698, 157700, 157704, 157706, 157950, 157952, 157956, 157958,
    157968, 157970, 157974, 157976, 158004, 158006, 158010, 158012, 158022, 158024, 158028, 158030,
    158112, 158114, 158118, 158120, 158130, 158132, 158136, 158138, 158166, 158168, 158172, 158174,
    158184, 158186, 158190, 158192, 158922, 158924, 158928, 158930, 158940, 158942, 158946, 158948,
    158976, 158978, 158982, 158984, 158994, 158996, 159000, 159002, 159084, 159086, 159090, 159092,
    159102, 159104, 159108, 159110, 159138, 159140, 159144, 159146, 159156, 159158, 159162, 159164,
    159408, 159410, 159414, 159416, 159426, 159428, 159432, 159434, 159462, 159464, 159468, 159470,
    159480, 159482, 159486, 159488, 159570, 159572, 159576, 159578, 159588, 159590, 159594, 159596,
    159624, 159626, 159630, 159632, 159642, 159644, 159648, 159650, 161838, 161840, 161844, 161846,
    161856, 161858, 161862, 161864, 161892, 161894, 161898, 161900, 161910, 161912, 161916, 161918,
    162000, 162002, 162006, 162008, 162018, 162020, 162024, 162026, 162054, 162056, 162060, 162062,
    162072, 162074, 162078, 162080, 162324, 162326, 162330, 162332, 162342, 162344, 162348, 162350,
    162378, 162380, 162384, 162386, 162396, 162398, 162402, 162404, 162486, 162488, 162492, 162494,
    162504, 162506, 162510, 162512, 162540, 162542, 162546, 162548, 162558, 162560, 162564, 162566,
    163296, 163298, 163302, 163304, 163314, 163316, 163320, 163322, 163350, 163352, 163356, 163358,
    163368, 163370, 163374, 163376, 163458, 163460, 163464, 163466, 163476, 163478, 163482, 163484,
    163512, 163514, 163518, 163520, 163530, 163532, 163536, 163538, 163782, 163784, 163788, 163790,
    163800, 163802, 163806, 163808, 163836, 163838, 163842, 163844, 163854, 163856, 163860, 163862,
    163944, 163946, 163950, 163952, 163962, 163964, 163968, 163970, 163998, 164000, 164004, 164006,
    164016, 164018, 164022, 164024, 170586, 170588, 170592, 170594, 170604, 170606, 170610, 170612,
    170640, 170642, 170646, 170648, 170658, 170660, 170664, 170666, 170748, 170750, 170754, 170756,
    170766, 170768, 170772, 170774, 170802, 170804, 170808, 170810, 170820, 170822, 170826, 170828,
    171072, 171074, 171078, 171080, 171090, 171092, 171096, 171098, 171126, 171128, 171132, 171134,
    171144, 171146, 171150, 171152, 171234, 171236, 171240, 171242, 171252, 171254, 171258, 171260,
    171288, 171290, 171294, 171296, 171306, 171308, 171312, 171314, 172044, 172046, 172050, 172052,
    172062, 172064, 172068, 172070, 172098, 172100, 172104, 172106, 172116, 172118, 172122, 172124,
    172206, 172208, 172212, 172214, 172224, 172226, 172230, 172232, 172260, 172262, 172266, 172268,
    172278, 172280, 172284, 172286, 172530, 172532, 172536, 172538, 172548, 172550, 172554, 172556,
    172584, 172586, 172590, 172592, 172602, 172604, 172608, 172610, 172692, 172694, 172698, 172700,
    172710, 172712, 172716, 172718, 172746, 172748, 172752, 172754, 172764, 172766, 172770, 172772,
    174960, 174962, 174966, 174968, 174978, 174980, 174984, 174986, 175014, 175016, 175020, 175022,
    175032, 175034, 175038, 175040, 175122, 175124, 175128, 175130, 175140, 175142, 175146, 175148,
    175176, 175178, 175182, 175184, 175194, 175196, 175200, 175202, 175446, 175448, 175452, 175454,
    175464, 175466, 175470, 175472, 175500, 175502, 175506, 175508, 175518, 175520, 175524, 175526,
    175608, 175610, 175614, 175616, 175626, 175628, 175632, 175634, 175662, 175664, 175668, 175670,
    175680, 175682, 175686, 175688, 176418, 176420, 176424, 176426, 176436, 176438, 176442, 176444,
    176472, 176474, 176478, 176480, 176490, 176492, 176496, 176498, 176580, 176582, 176586, 176588,
    176598, 176600, 176604, 176606, 176634, 176636, 176640, 176642, 176652, 176654, 176658, 176660,
    176904, 176906, 176910, 176912, 176922, 176924, 176928, 176930, 176958, 176960, 176964, 176966,
    176976, 176978, 176982, 176984, 177066, 177068, 177072, 177074, 177084, 177086, 177090, 177092,
    177120, 177122, 177126, 177128, 177138, 177140, 177144, 177146, 354294, 354296, 354300, 354302,
    354312, 354314, 354318, 354320, 354348, 354350, 354354, 354356, 354366, 354368, 354372, 354374,
    354456, 354458, 354462, 354464, 354474, 354476, 354480, 354482, 354510, 354512, 354516, 354518,
    354528, 354530, 354534, 354536, 354780, 354782, 354786, 354788, 354798, 354800, 354804, 354806,
    354834, 354836, 354840, 354842, 354852, 354854, 354858, 354860, 354942, 354944, 354948, 354950,
    354960, 354962, 354966, 354968, 354996, 354998, 355002, 355004, 355014, 355016, 355020, 355022,
    355752, 355754, 355758, 355760, 355770, 355772, 355776, 355778, 355806, 355808, 355812, 355814,
    355824, 355826, 355830, 355832, 355914, 355916, 355920, 355922, 355932, 355934, 355938, 355940,
    355968, 355970, 355974, 355976, 355986, 355988, 355992, 355994, 356238, 356240, 356244, 356246,
    356256, 356258, 356262, 356264, 356292, 356294, 356298, 356300, 356310, 356312, 356316, 356318,
    356400, 356402, 356406, 356408, 356418, 356420, 356424, 356426, 356454, 356456, 356460, 356462,
    356472, 356474, 356478, 356480, 358668, 358670, 358674, 358676, 358686, 358688, 358692, 358694,
    358722, 358724, 358728, 358730, 358740, 358742, 358746, 358748, 358830, 358832, 358836, 358838,
    358848, 358850, 358854, 358856, 358884, 358886, 358890, 358892, 358902, 358904, 358908, 358910,
    359154, 359156, 359160, 359162, 359172, 359174, 359178, 359180, 359208, 359210, 359214, 359216,
    359226, 359228, 359232, 359234, 359316, 359318, 359322, 359324, 359334, 359336, 359340, 359342,
    359370, 359372, 359376, 359378, 359388, 359390, 359394, 359396, 360126, 360128, 360132, 360134,
    360144, 360146, 360150, 360152, 360180, 360182, 360186, 360188, 360198, 360200, 360204, 360206,
    360288, 360290, 360294, 360296, 360306, 360308, 360312, 360314, 360342, 360344, 360348, 360350,
    360360, 360362, 360366, 360368, 360612, 360614, 360618, 360620, 360630, 360632, 360636, 360638,
    360666, 360668, 360672, 360674, 360684, 360686, 360690, 360692, 360774, 360776, 360780, 360782,
    360792, 360794, 360798, 360800, 360828, 360830, 360834, 360836, 360846, 360848, 360852, 360854,
    367416, 367418, 367422, 367424, 367434, 367436, 367440, 367442, 367470, 367472, 367476, 367478,
    367488, 367490, 367494, 367496, 367578, 367580, 367584, 367586, 367596, 367598, 367602, 367604,
    367632, 367634, 367638, 367640, 367650, 367652, 367656, 367658, 367902, 367904, 367908, 367910,
    367920, 367922, 367926, 367928, 367956, 367958, 367962, 367964, 367974, 367976, 367980, 367982,
    368064, 368066, 368070, 368072, 368082, 368084, 368088, 368090, 368118, 368120, 368124, 368126,
    368136, 368138, 368142, 368144, 368874, 368876, 368880, 368882, 368892, 368894, 368898, 368900,
    368928, 368930, 368934, 368936, 368946, 368948, 368952, 368954, 369036, 369038, 369042, 369044,
    369054, 369056, 369060, 369062, 369090, 369092, 369096, 369098, 369108, 369110, 369114, 369116,
    369360, 369362, 369366, 369368, 369378, 369380, 369384, 369386, 369414, 369416, 369420, 369422,
    369432, 369434, 369438, 369440, 369522, 369524, 369528, 369530, 369540, 369542, 369546, 369548,
    369576, 369578, 369582, 369584, 369594, 369596, 369600, 369602, 371790, 371792, 371796, 371798,
    371808, 371810, 371814, 371816, 371844, 371846, 371850, 371852, 371862, 371864, 371868, 371870,
    371952, 371954, 371958, 371960, 371970, 371972, 371976, 371978, 372006, 372008, 372012, 372014,
    372024, 372026, 372030, 372032, 372276, 372278, 372282, 372284, 372294, 372296, 372300, 372302,
    372330, 372332, 372336, 372338, 372348, 372350, 372354, 372356, 372438, 372440, 372444, 372446,
    372456, 372458, 372462, 372464, 372492, 372494, 372498, 372500, 372510, 372512, 372516, 372518,
    373248, 373250, 373254, 373256, 373266, 373268, 373272, 373274, 373302, 373304, 373308, 373310,
    373320, 373322, 373326, 373328, 373410, 373412, 373416, 373418, 373428, 373430, 373434, 373436,
    373464, 373466, 373470, 373472, 373482, 373484, 373488, 373490, 373734, 373736, 373740, 373742,
    373752, 373754, 373758, 373760, 373788, 373790, 373794, 373796, 373806, 373808, 373812, 373814,
    373896, 373898, 373902, 373904, 373914, 373916, 373920, 373922, 373950, 373952, 373956, 373958,
    373968, 373970, 373974, 373976, 393660, 393662, 393666, 393668, 393678, 393680, 393684, 393686,
    393714, 393716, 393720, 393722, 393732, 393734, 393738, 393740, 393822, 393824, 393828, 393830,
    393840, 393842, 393846, 393848, 393876, 393878, 393882, 393884, 393894, 393896, 393900, 393902,
    394146, 394148, 394152, 394154, 394164, 394166, 394170, 394172, 394200, 394202, 394206, 394208,
    394218, 394220, 394224, 394226, 394308, 394310, 394314, 394316, 394326, 394328, 394332, 394334,
    394362, 394364, 394368, 394370, 394380, 394382, 394386, 394388, 395118, 395120, 395124, 395126,
    395136, 395138, 395142, 395144, 395172, 395174, 395178, 395180, 395190, 395192, 395196, 395198,
    395280, 395282, 395286, 395288, 395298, 395300, 395304, 395306, 395334, 395336, 395340, 395342,
    395352, 395354, 395358, 395360, 395604, 395606, 395610, 395612, 395622, 395624, 395628, 395630,
    395658, 395660, 395664, 395666, 395676, 395678, 395682, 395684, 395766, 395768, 395772, 395774,
    395784, 395786, 395790, 395792, 395820, 395822, 395826, 395828, 395838, 395840, 395844, 395846,
    398034, 398036, 398040, 398042, 398052, 398054, 398058, 398060, 398088, 398090, 398094, 398096,
    398106, 398108, 398112, 398114, 398196, 398198, 398202, 398204, 398214, 398216, 398220, 398222,
    398250, 398252, 398256, 398258, 398268, 398270, 398274, 398276, 398520, 398522, 398526, 398528,
    398538, 398540, 398544, 398546, 398574, 398576, 398580, 398582, 398592, 398594, 398598, 398600,
    398682, 398684, 398688, 398690, 398700, 398702, 398706, 398708, 398736, 398738, 398742, 398744,
    398754, 398756, 398760, 398762, 399492, 399494, 399498, 399500, 399510, 399512, 399516, 399518,
    399546, 399548, 399552, 399554, 399564, 399566, 399570, 399572, 399654, 399656, 399660, 399662,
    399672, 399674, 399678, 399680, 399708, 399710, 399714, 399716, 399726, 399728, 399732, 399734,
    399978, 399980, 399984, 399986, 399996, 399998, 400002, 400004, 400032, 400034, 400038, 400040,
    400050, 400052, 400056, 400058, 400140, 400142, 400146, 400148, 400158, 400160, 400164, 400166,
    400194, 400196, 400200, 400202, 400212, 400214, 400218, 400220, 406782, 406784, 406788, 406790,
    406800, 406802, 406806, 406808, 406836, 406838, 406842, 406844, 406854, 406856, 406860, 406862,
    406944, 406946, 406950, 406952, 406962, 406964, 406968, 406970, 406998, 407000, 407004, 407006,
    407016, 407018, 407022, 407024, 407268, 407270, 407274, 407276, 407286, 407288, 407292, 407294,
    407322, 407324, 407328, 407330, 407340, 407342, 407346, 407348, 407430, 407432, 407436, 407438,
    407448, 407450, 407454, 407456, 407484, 407486, 407490, 407492, 407502, 407504, 407508, 407510,
    408240, 408242, 408246, 408248, 408258, 408260, 408264, 408266, 408294, 408296, 408300, 408302,
    408312, 408314, 408318, 408320, 408402, 408404, 408408, 408410, 408420, 408422, 408426, 408428,
    408456, 408458, 408462, 408464, 408474, 408476, 408480, 408482, 408726, 408728, 408732, 408734,
    408744, 408746, 408750, 408752, 408780, 408782, 408786, 408788, 408798, 408800, 408804, 408806,
    408888, 408890, 408894, 408896, 408906, 408908, 408912, 408914, 408942, 408944, 408948, 408950,
    408960, 408962, 408966, 408968, 411156, 411158, 411162, 411164, 411174, 411176, 411180, 411182,
    411210, 411212, 411216, 411218, 411228, 411230, 411234, 411236, 411318, 411320, 411324, 411326,
    411336, 411338, 411342, 411344, 411372, 411374, 411378, 411380, 411390, 411392, 411396, 411398,
    411642, 411644, 411648, 411650, 411660, 411662, 411666, 411668, 411696, 411698, 411702, 411704,
    411714, 411716, 411720, 411722, 411804, 411806, 411810, 411812, 411822, 411824, 411828, 411830,
    411858, 411860, 411864, 411866, 411876, 411878, 411882, 411884, 412614, 412616, 412620, 412622,
    412632, 412634, 412638, 412640, 412668, 412670, 412674, 412676, 412686, 412688, 412692, 412694,
    412776, 412778, 412782, 412784, 412794, 412796, 412800, 412802, 412830, 412832, 412836, 412838,
    412848, 412850, 412854, 412856, 413100, 413102, 413106, 413108, 413118, 413120, 413124, 413126,
    413154, 413156, 413160, 413162, 413172, 413174, 413178, 413180, 413262, 413264, 413268, 413270,
    413280, 413282, 413286, 413288, 413316, 413318, 413322, 413324, 413334, 413336, 413340, 413342,
    472392, 472394, 472398, 472400, 472410, 472412, 472416, 472418, 472446, 472448, 472452, 472454,
    472464, 472466, 472470, 472472, 472554, 472556, 472560, 472562, 472572, 472574, 472578, 472580,
    472608, 472610, 472614, 472616, 472626, 472628, 472632, 472634, 472878, 472880, 472884, 472886,
    472896, 472898, 472902, 472904, 472932, 472934, 472938, 472940, 472950, 472952, 472956, 472958,
    473040, 473042, 473046, 473048, 473058, 473060, 473064, 473066, 473094, 473096, 473100, 473102,
    473112, 473114, 473118, 473120, 473850, 473852, 473856, 473858, 473868, 473870, 473874, 473876,
    473904, 473906, 473910, 473912, 473922, 473924, 473928, 473930, 474012, 474014, 474018, 474020,
    474030, 474032, 474036, 474038, 474066, 474068, 474072, 474074, 474084, 474086, 474090, 474092,
    474336, 474338, 474342, 474344, 474354, 474356, 474360, 474362, 474390, 474392, 474396, 474398,
    474408, 474410, 474414, 474416, 474498, 474500, 474504, 474506, 474516, 474518, 474522, 474524,
    474552, 474554, 474558, 474560, 474570, 474572, 474576, 474578, 476766, 476768, 476772, 476774,
    476784, 476786, 476790, 476792, 476820, 476822, 476826, 476828, 476838, 476840, 476844, 476846,
    476928, 476930, 476934, 476936, 476946, 476948, 476952, 476954, 476982, 476984, 476988, 476990,
    477000, 477002, 477006, 477008, 477252, 477254, 477258, 477260, 477270, 477272, 477276, 477278,
    477306, 477308, 477312, 477314, 477324, 477326, 477330, 477332, 477414, 477416, 477420, 477422,
    477432, 477434, 477438, 477440, 477468, 477470, 477474, 477476, 477486, 477488, 477492, 477494,
    478224, 478226, 478230, 478232, 478242, 478244, 478248, 478250, 478278, 478280, 478284, 478286,
    478296, 478298, 478302, 478304, 478386, 478388, 478392, 478394, 478404, 478406, 478410, 478412,
    478440, 478442, 478446, 478448, 478458, 478460, 478464, 478466, 478710, 478712, 478716, 478718,
    478728, 478730, 478734, 478736, 478764, 478766, 478770, 478772, 478782, 478784, 478788, 478790,
    478872, 478874, 478878, 478880, 478890, 478892, 478896, 478898, 478926, 478928, 478932, 478934,
    478944, 478946, 478950, 478952, 485514, 485516, 485520, 485522, 485532, 485534, 485538, 485540,
    485568, 485570, 485574, 485576, 485586, 485588, 485592, 485594, 485676, 485678, 485682, 485684,
    485694, 485696, 485700, 485702, 485730, 485732, 485736, 485738, 485748, 485750, 485754, 485756,
    486000, 486002, 486006, 486008, 486018, 486020, 486024, 486026, 486054, 486056, 486060, 486062,
    486072, 486074, 486078, 486080, 486162, 486164, 486168, 486170, 486180, 486182, 486186, 486188,
    486216, 486218, 486222, 486224, 486234, 486236, 486240, 486242, 486972, 486974, 486978, 486980,
    486990, 486992, 486996, 486998, 487026, 487028, 487032, 487034, 487044, 487046, 487050, 487052,
    487134, 487136, 487140, 487142, 487152, 487154, 487158, 487160, 487188, 487190, 487194, 487196,
    487206, 487208, 487212, 487214, 487458, 487460, 487464, 487466, 487476, 487478, 487482, 487484,
    487512, 487514, 487518, 487520, 487530, 487532, 487536, 487538, 487620, 487622, 487626, 487628,
    487638, 487640, 487644, 487646, 487674, 487676, 487680, 487682, 487692, 487694, 487698, 487700,
    489888, 489890, 489894, 489896, 489906, 489908, 489912, 489914, 489942, 489944, 489948, 489950,
    489960, 489962, 489966, 489968, 490050, 490052, 490056, 490058, 490068, 490070, 490074, 490076,
    490104, 490106, 490110, 490112, 490122, 490124, 490128, 490130, 490374, 490376, 490380, 490382,
    490392, 490394, 490398, 490400, 490428, 490430, 490434, 490436, 490446, 490448, 490452, 490454,
    490536, 490538, 490542, 490544, 490554, 490556, 490560, 490562, 490590, 490592, 490596, 490598,
    490608, 490610, 490614, 490616, 491346, 491348, 491352, 491354, 491364, 491366, 491370, 491372,
    491400, 491402, 491406, 491408, 491418, 491420, 491424, 491426, 491508, 491510, 491514, 491516,
    491526, 491528, 491532, 491534, 491562, 491564, 491568, 491570, 491580, 491582, 491586, 491588,
    491832, 491834, 491838, 491840, 491850, 491852, 491856, 491858, 491886, 491888, 491892, 491894,
    491904, 491906, 491910, 491912, 491994, 491996, 492000, 492002, 492012, 492014, 492018, 492020,
    492048, 492050, 492054, 492056, 492066, 492068, 492072, 492074, 511758, 511760, 511764, 511766,
    511776, 511778, 511782, 511784, 511812, 511814, 511818, 511820, 511830, 511832, 511836, 511838,
    511920, 511922, 511926, 511928, 511938, 511940, 511944, 511946, 511974, 511976, 511980, 511982,
    511992, 511994, 511998, 512000, 512244, 512246, 512250, 512252, 512262, 512264, 512268, 512270,
    512298, 512300, 512304, 512306, 512316, 512318, 512322, 512324, 512406, 512408, 512412, 512414,
    512424, 512426, 512430, 512432, 512460, 512462, 512466, 512468, 512478, 512480, 512484, 512486,
    513216, 513218, 513222, 513224, 513234, 513236, 513240, 513242, 513270, 513272, 513276, 513278,
    513288, 513290, 513294, 513296, 513378, 513380, 513384, 513386, 513396, 513398, 513402, 513404,
    513432, 513434, 513438, 513440, 513450, 513452, 513456, 513458, 513702, 513704, 513708, 513710,
    513720, 513722, 513726, 513728, 513756, 513758, 513762, 513764, 513774, 513776, 513780, 513782,
    513864, 513866, 513870, 513872, 513882, 513884, 513888, 513890, 513918, 513920, 513924, 513926,
    513936, 513938, 513942, 513944, 516132, 516134, 516138, 516140, 516150, 516152, 516156, 516158,
    516186, 516188, 516192, 516194, 516204, 516206, 516210, 516212, 516294, 516296, 516300, 516302,
    516312, 516314, 516318, 516320, 516348, 516350, 516354, 516356, 516366, 516368, 516372, 516374,
    516618, 516620, 516624, 516626, 516636, 516638, 516642, 516644, 516672, 516674, 516678, 516680,
    516690, 516692, 516696, 516698, 516780, 516782, 516786, 516788, 516798, 516800, 516804, 516806,
    516834, 516836, 516840, 516842, 516852, 516854, 516858, 516860, 517590, 517592, 517596, 517598,
    517608, 517610, 517614, 517616, 517644, 517646, 517650, 517652, 517662, 517664, 517668, 517670,
    517752, 517754, 517758, 517760, 517770, 517772, 517776, 517778, 517806, 517808, 517812, 517814,
    517824, 517826, 517830, 517832, 518076, 518078, 518082, 518084, 518094, 518096, 518100, 518102,
    518130, 518132, 518136, 518138, 518148, 518150, 518154, 518156, 518238, 518240, 518244, 518246,
    518256, 518258, 518262, 518264, 518292, 518294, 518298, 518300, 518310, 518312, 518316, 518318,
    524880, 524882, 524886, 524888, 524898, 524900, 524904, 524906, 524934, 524936, 524940, 524942,
    524952, 524954, 524958, 524960, 525042, 525044, 525048, 525050, 525060, 525062, 525066, 525068,
    525096, 525098, 525102, 525104, 525114, 525116, 525120, 525122, 525366, 525368, 525372, 525374,
    525384, 525386, 525390, 525392, 525420, 525422, 525426, 525428, 525438, 525440, 525444, 525446,
    525528, 525530, 525534, 525536, 525546, 525548, 525552, 525554, 525582, 525584, 525588, 525590,
    525600, 525602, 525606, 525608, 526338, 526340, 526344, 526346, 526356, 526358, 526362, 526364,
    526392, 526394, 526398, 526400, 526410, 526412, 526416, 526418, 526500, 526502, 526506, 526508,
    526518, 526520, 526524, 526526, 526554, 526556, 526560, 526562, 526572, 526574, 526578, 526580,
    526824, 526826, 526830, 526832, 526842, 526844, 526848, 526850, 526878, 526880, 526884, 526886,
    526896, 526898, 526902, 526904, 526986, 526988, 526992, 526994, 527004, 527006, 527010, 527012,
    527040, 527042, 527046, 527048, 527058, 527060, 527064, 527066, 529254, 529256, 529260, 529262,
    529272, 529274, 529278, 529280, 529308, 529310, 529314, 529316, 529326, 529328, 529332, 529334,
    529416, 529418, 529422, 529424, 529434, 529436, 529440, 529442, 529470, 529472, 529476, 529478,
    529488, 529490, 529494, 529496, 529740, 529742, 529746, 529748, 529758, 529760, 529764, 529766,
    529794, 529796, 529800, 529802, 529812, 529814, 529818, 529820, 529902, 529904, 529908, 529910,
    529920, 529922, 529926, 529928, 529956, 529958, 529962, 529964, 529974, 529976, 529980, 529982,
    530712, 530714, 530718, 530720, 530730, 530732, 530736, 530738, 530766, 530768, 530772, 530774,
    530784, 530786, 530790, 530792, 530874, 530876, 530880, 530882, 530892, 530894, 530898, 530900,
    530928, 530930, 530934, 530936, 530946, 530948, 530952, 530954, 531198, 531200, 531204, 531206,
    531216, 531218, 531222, 531224, 531252, 531254, 531258, 531260, 531270, 531272, 531276, 531278,
    531360, 531362, 531366, 531368, 531378, 531380, 531384, 531386, 531414, 531416, 531420, 531422,
    531432, 531434, 531438, 531440
];

#[cfg(all(target_arch="x86_64", target_feature="bmi2"))]
fn pdep64(a: u64, mask: u64) -> u64 {
    unsafe {
        _pdep_u64(a, mask)
    }
}

#[cfg(all(target_arch="x86", target_feature="bmi2"))]
fn pdep64(a: u64, mask: u64) -> u64 {
    let mask_low = mask & 0xFF_FF_FF_FF;
    let low = unsafe {
        _pdep_u32((a & 0xFF_FF_FF_FF) as u32, mask_low as u32)
    };

    let high = unsafe {
        _pdep_u32(a >> 32, mask >> mask_low.count_ones())
    };

    low | (high << 32)
}

#[cfg(not(target_feature="bmi2"))]
fn pdep64(a: u64, mask: u64) -> u64 {
    let mut temp = mask;
    let mut dst = 0;
    let mut idx = 1u64;
    
    while temp != 0 {
        if a & idx != 0 {
            dst |= temp & temp.wrapping_neg();
        }
        temp &= temp - 1;
        idx = idx.wrapping_add(idx);
    }

    dst
}

#[cfg(all(target_arch="x86_64", target_feature="bmi2"))]
fn pext64(a: u64, mask: u64) -> u64 {
    unsafe {
        _pext_u64(a, mask)
    }
}

#[cfg(all(target_arch="x86", target_feature="bmi2"))]
fn pext64(a: u64, mask: u64) -> u64 {
    let mask_low = mask & 0xFF_FF_FF_FF;
    let low = unsafe {
        _pext_u32((a & 0xFF_FF_FF_FF) as u32, mask_low as u32)
    };

    let high = unsafe {
        _pext_u32(a >> 32, mask >> 32)
    };

    low | (high << mask_low.count_ones())
}

#[cfg(not(target_feature="bmi2"))]
fn pext64(a: u64, mask: u64) -> u64 {
    let mut temp = mask;
    let mut dst = 0;
    let mut idx = 1u64;
    
    while temp != 0 {
        if a & temp & temp.wrapping_neg() != 0 {
            dst |= idx;
        }
        idx = idx.wrapping_add(idx);
        temp &= temp - 1;
    }

    dst
}

#[cfg(target_arch="x86_64")]
fn flip_vertical(a: u64) -> u64 {
    unsafe {
        _bswap64(a as i64) as u64
    }
}

#[cfg(not(target_arch="x86_64"))]
fn flip_vertical(a: u64) -> u64 {
    const K1: u64 = 0x00FF00FF00FF00FF;
    const K2: u64 = 0x0000FFFF0000FFFF;
    
    let mut x = 0;
    x = ((a >>  8) & K1) | ((a & K1) <<  8);
    x = ((a >> 16) & K2) | ((a & K2) << 16);
    x = ( a >> 32)       | ( a       << 32);
    
    x
}

fn flip_diag(a: u64) -> u64 {
    const K1: u64 = 0x5500550055005500;
    const K2: u64 = 0x3333000033330000;
    const K4: u64 = 0x0f0f0f0f00000000;
    
    let mut t;
    let mut x = a;
    
    t  = K4 & (x ^ (x << 28));
    x ^=       t ^ (t >> 28) ;
    t  = K2 & (x ^ (x << 14));
    x ^=       t ^ (t >> 14) ;
    t  = K1 & (x ^ (x <<  7));
    x ^=       t ^ (t >>  7) ;

    x
}

#[derive(Default)]
pub struct PatternEvaluator {
    patterns: Vec<(u64, Vec<f32>)>
}

impl PatternEvaluator {
    pub fn new() -> Self {
        PatternEvaluator {
            patterns: Vec::new()
        }
    }

    pub fn from(masks: Vec<u64>, weights: Vec<Vec<f32>>) -> PatternEvaluator {
        let rotate = | mask: u64, weight: &Vec<f32> | {
            let mut new_masks = vec![mask];
            let mut new_weights = vec![weight.clone()];

            let max_idx = 3usize.pow(mask.count_ones() as u32);
            let max_val = 2usize.pow(mask.count_ones() as u32);

            let mut board = [-1; 64];
            let mut idx = 0;
            for i in 0..64 {
                if mask & (0x80_00_00_00_00_00_00_00 << i) == 1 {
                    board[i] = idx;
                    idx += 1;
                } 
            }

            let rotate_board = | a: u64, i: u8 | {
                let mut temp = a;
                for _ in 0..i {
                    temp = flip_vertical(flip_diag(temp));
                }
                temp
            };

            for r in 1..4 {
                // 90 degree clockwise rotation
                let rotated = rotate_board(mask, r);
                
                //iterate through 0..3**n
                //pdep into pattern
                //rotate pdeped val
                //pext with rotated pattern
                //write to vec at index

                let mut rot_weight = vec![0.0; max_idx];
                for i in 0..max_val {
                    for j in 0..max_val {
                        if i & j == 0 {
                            let mut idep = pdep64(i as u64, mask);
                            let mut jdep = pdep64(j as u64, mask);
                            idep = rotate_board(idep, r);
                            jdep = rotate_board(jdep, r);
                            let iext = pext64(idep, rotated) as usize;
                            let jext = pext64(jdep, rotated) as usize;
                            rot_weight[ONES_TERNARY[iext] + TWOS_TERNARY[jext]] = weight[ONES_TERNARY[i] + TWOS_TERNARY[j]];
                        }
                    }
                }

                new_masks.push(rotated);
                new_weights.push(rot_weight);
            }

            (new_masks, new_weights)
        };

        let mut all_masks = vec![];
        let mut all_weights = vec![];

        masks.iter().zip(weights).map(| (&m, w) | rotate(m, &w)).for_each(| (mut m, mut w) | {
            all_masks.append(&mut m);
            all_weights.append(&mut w);
        });

        PatternEvaluator {
            patterns: all_masks.iter().zip(all_weights).map(| (&m, w) | (m, w)).collect()
        }
    }
}

impl super::Evaluator for PatternEvaluator {
    fn get_score(&self, board: &Board) -> i32 {
        let mut score: f32 = 0.0;
        let blacks = board.black_disks;
        let whites = board.white_disks;

        for (mask, weights) in self.patterns.iter() {
            // Extract the pattern from both bitboards
            let black_pat = pext64(blacks, *mask) as usize;
            let white_pat = pext64(whites, *mask) as usize;
            // Get the index of the given pattern
            let index = ONES_TERNARY[white_pat] + TWOS_TERNARY[black_pat];

            // Add the pattern's weight to the score
            score += weights[index];
        }

        if board.black_move {
            score as i32
        } else {
            -score as i32
        }
    }
}
